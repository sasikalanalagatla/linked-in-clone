<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title th:text="${education.educationId != null ? 'Edit Education' : 'Add Education'}">Add Education</title>
    <meta charset="UTF-8">
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f0f2f5;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
        }

        .form-container {
            background-color: #fff;
            padding: 32px;
            width: 600px;
            border-radius: 12px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        h2 {
            text-align: center;
            margin-bottom: 24px;
            color: #2c3e50;
        }

        form {
            display: grid;
            gap: 16px;
        }

        label {
            font-weight: 500;
            color: #34495e;
            display: block;
            margin-bottom: 6px;
        }

        input, textarea, select {
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 6px;
            font-size: 15px;
            width: 100%;
            box-sizing: border-box;
        }

        .form-row {
            display: flex;
            gap: 16px;
        }

        .form-group {
            flex: 1;
        }

        .form-group-full {
            grid-column: 1 / -1;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            margin-top: 8px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin-right: 8px;
        }

        .btn-submit {
            background-color: #0a66c2;
            color: white;
            border: none;
            padding: 12px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-submit:hover {
            background-color: #084c91;
        }

        .btn-cancel {
            background-color: #f0f2f5;
            color: #0a66c2;
            border: 1px solid #0a66c2;
            padding: 12px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.2s;
            text-decoration: none;
            display: inline-block;
            text-align: center;
        }

        .btn-cancel:hover {
            background-color: #e1e5eb;
        }

        .btn-delete {
            background-color: #dc3545;
            color: white;
            border: none;
            padding: 12px;
            font-size: 16px;
            border-radius: 6px;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-delete:hover {
            background-color: #c82333;
        }

        .button-group {
            display: flex;
            gap: 12px;
            margin-top: 16px;
        }

        .button-group-left {
            flex: 1;
        }

        .button-group-right {
            display: flex;
            gap: 12px;
        }

        .error-message {
            color: red;
            font-size: 14px;
            margin-top: 4px;
        }

        .success-message {
            color: green;
            font-size: 14px;
            margin-bottom: 16px;
            padding: 10px;
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            border-radius: 6px;
        }

        .general-error {
            color: red;
            font-size: 14px;
            margin-bottom: 16px;
            padding: 10px;
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
            border-radius: 6px;
        }

        /* Modal styles */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0,0,0,0.5);
        }

        .modal-content {
            background-color: #fff;
            margin: 15% auto;
            padding: 20px;
            border-radius: 8px;
            width: 400px;
            max-width: 90%;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #eee;
        }

        .modal-title {
            margin: 0;
            color: #dc3545;
        }

        .close {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: #999;
        }

        .close:hover {
            color: #000;
        }

        .modal-body {
            margin-bottom: 20px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }

        .education-info {
            background-color: #f8f9fa;
            padding: 10px;
            border-radius: 6px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
<div class="form-container">
    <h2 th:text="${education.educationId != null ? 'Edit Education' : 'Add Education'}">Add Education</h2>

    <!-- Success Message -->
    <div th:if="${success}" class="success-message" th:text="${success}"></div>

    <!-- Error Message -->
    <div th:if="${error}" class="general-error" th:text="${error}"></div>

    <form th:action="${education.educationId != null ? '/update/education/' + education.educationId : '/add/education/' + user.userId}"
          th:object="${education}"
          method="post">

        <div class="form-group">
            <label for="schoolName">School/Institution *</label>
            <input type="text" id="schoolName" th:field="*{schoolName}"
                   placeholder="Ex: Harvard University, MIT, Stanford" required>
            <div th:if="${#fields.hasErrors('schoolName')}" th:errors="*{schoolName}" class="error-message"></div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="degree">Degree *</label>
                <input type="text" id="degree" th:field="*{degree}"
                       placeholder="Ex: Bachelor of Science, Master of Arts" required>
                <div th:if="${#fields.hasErrors('degree')}" th:errors="*{degree}" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="fieldOfStudy">Field of Study</label>
                <input type="text" id="fieldOfStudy" th:field="*{fieldOfStudy}"
                       placeholder="Ex: Computer Science, Business Administration">
                <div th:if="${#fields.hasErrors('fieldOfStudy')}" th:errors="*{fieldOfStudy}" class="error-message"></div>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="startDate">Start Year *</label>
                <input type="number" id="startDate" th:field="*{startDate}"
                       placeholder="Ex: 2020"
                       min="1950" max="2030"
                       required>
                <div th:if="${#fields.hasErrors('startDate')}" th:errors="*{startDate}" class="error-message"></div>
            </div>
            <div class="form-group">
                <label for="endDate">End Year</label>
                <input type="number" id="endDate" th:field="*{endDate}"
                       placeholder="Ex: 2024"
                       min="1950" max="2030">
                <div th:if="${#fields.hasErrors('endDate')}" th:errors="*{endDate}" class="error-message"></div>
            </div>
        </div>

        <div class="form-row">
            <div class="form-group">
                <label for="grade">Grade/GPA</label>
                <input type="text" id="grade" th:field="*{grade}"
                       placeholder="Ex: 3.8 GPA, First Class, A+">
                <div th:if="${#fields.hasErrors('grade')}" th:errors="*{grade}" class="error-message"></div>
            </div>
            <div class="form-group">
                <!-- Empty div to maintain grid layout -->
            </div>
        </div>

        <div class="form-group">
            <label for="extraCurricularActivity">Extra Curricular Activities</label>
            <textarea id="extraCurricularActivity" th:field="*{extraCurricularActivity}" rows="3"
                      placeholder="List any extracurricular activities, clubs, or societies"></textarea>
            <div th:if="${#fields.hasErrors('extraCurricularActivity')}" th:errors="*{extraCurricularActivity}" class="error-message"></div>
        </div>

        <div class="button-group">
            <div class="button-group-left">
                <a th:href="@{'/profile/' + ${user.userId}}" class="btn-cancel">Cancel</a>
            </div>
            <div class="button-group-right">
                <!-- Show delete button only when editing -->
                <button type="button"
                        th:if="${education.educationId != null}"
                        class="btn-delete"
                        onclick="openDeleteModal()">
                    Delete
                </button>
                <button class="btn-submit" type="submit"
                        th:text="${education.educationId != null ? 'Update Education' : 'Save Education'}">
                    Save Education
                </button>
            </div>
        </div>
    </form>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="modal" th:if="${education.educationId != null}">
    <div class="modal-content">
        <div class="modal-header">
            <h3 class="modal-title">Confirm Deletion</h3>
            <button class="close" onclick="closeDeleteModal()">&times;</button>
        </div>
        <div class="modal-body">
            <p>Are you sure you want to delete this education entry?</p>
            <div class="education-info">
                <strong th:text="${education.schoolName}">School Name</strong><br>
                <span th:text="${education.degree}">Degree</span>
                <span th:if="${education.fieldOfStudy}" th:text="' in ' + ${education.fieldOfStudy}">in Field</span>
            </div>
            <p style="color: #666; font-size: 14px;">This action cannot be undone.</p>
        </div>
        <div class="modal-footer">
            <button class="btn-cancel" onclick="closeDeleteModal()">Cancel</button>
            <form th:action="@{'/delete/education/' + ${education.educationId}}" method="post" style="display: inline;">
                <button type="submit" class="btn-delete">Delete Education</button>
            </form>
        </div>
    </div>
</div>

<script>
    // Modal functions
    function openDeleteModal() {
        document.getElementById('deleteModal').style.display = 'block';
    }

    function closeDeleteModal() {
        document.getElementById('deleteModal').style.display = 'none';
    }

    // Close modal when clicking outside
    window.onclick = function(event) {
        const modal = document.getElementById('deleteModal');
        if (event.target === modal) {
            modal.style.display = 'none';
        }
    }
</script>
</body>
</html>